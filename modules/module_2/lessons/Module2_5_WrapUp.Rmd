---
title: "Module 2 Wrap-Up"
author: "Ellen Bledsoe"
date: "2022-10-13"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# What is causing the food poisoning?

## Set-up

Let's load the package and data we will need.

### Packages

```{r}
library(tidyverse)
```

### Data

We will likely want to look at both the fish tank dataset and the sick fish dataset, so we will read in both of them.

```{r}
fish_tank_data <- read_csv("../data/fish_tank_data.csv")
sick_fish <- read_csv("../data/fish_sick_data.csv")


# number of sick fish
ggplot(sick_fish, aes(num_sick, fill = species)) +
  geom_density(alpha = 0.5)

# take into account the number of fish in the tank: density of sick fish
sick_fish_density <- sick_fish %>% 
  mutate(density = num_sick/num_fish) 

ggplot(sick_fish_density, aes(density, fill = species)) +
  geom_density(alpha = 0.5)


ggplot(sick_fish_density, aes(species, density, color = species)) +
  geom_boxplot() + 
  geom_jitter(alpha = 0.5, width = 0.1)

# looks like trout are the culprit
```

## Back to Data Exploration

We now have 2 data frames, one with tilapia data and one with trout
data. Each data frame also has a new column called `temp_cutoff`. On
your own or with a partner, start exploring the data to figure out if
there are differences between warm and cold tilapia and warm and cold
trout.

Can you pinpoint an issue? Let's start by comparing means.

```{r}
sick_trout <- sick_fish_density %>% 
  filter(species == "trout")
```


## What's Causing the Problem?

### Density

Since temperature didn't seem to be the issue, let's try another tactic. Maybe density in the culprit. Higher densities of fish can lead to immunosuppresion, after all.

```{r}
ggplot(sick_trout, aes(x = density, y = num_fish)) +
  geom_point() +
  geom_smooth(method = "lm")

ggplot(sick_trout, aes(x = density, y = avg_daily_temp)) +
  geom_point() + 
  geom_smooth(method = "lm")

ggplot(sick_trout, aes(density, day_length)) +
  geom_point() + 
  geom_smooth(method = "lm")

ggplot(sick_trout, aes(density, size_day_30)) +
  geom_point() + 
  geom_smooth(method = "lm")

# looks like avg_daily_temperature might be our culprit!

```
